{% extends 'base.html.twig' %}

{% block body %}

	<div class="signup-wrapper space">
		<div class="container">
			<div class="row justify-content-center">
				<div class="col-lg-6">
					{% for label, messages in app.flashes %}
						{% for message in messages %}
							<div class="alert alert-{{ label }}">
								{{ message }}
							</div>
						{% endfor %}
					{% endfor %}
					{% if app.user %}

						{{ form_start(form, {
                    'attr': {
                        'id': 'register-form',
                        'class': 'signup-form bg-smoke',
                        'novalidate': 'novalidate'
                    }
                }) }}

						<h2 class="form-title text-center mb-lg-35">Modifier votre profil</h2>

						<div class="form-group text-center">
							<div class="custom-file-input-container">
								<label for="user-photo" class="custom-file-label">
									{% if app.user.photoProfil %}
										{% if app.user.photoProfil starts with 'http' %}
											<img class="profile-pic" src="{{ app.user.photoProfil }}" alt="Photo de profil">
										{% else %}
											<img class="profile-pic" src="{{ asset('uploads/profile/' ~ app.user.photoProfil) }}" alt="Photo de profil">
										{% endif %}
									{% else %}
										<i class="fas fa-user" style="font-size:72px; color: #ccc;"></i>
									{% endif %}
								</label>
								<input id="user-photo" type="file" name="photoProfil" class="hidden-file-input">
							</div>
						</div>
						<div class="form-group">
							{{ form_errors(form.prenom) }}
						</div>
						<div class="form-group">
							{{ form_widget(form.prenom,{'attr': {'class': 'form-control', 'placeholder': 'Prenom*'}}) }}
						</div>
						<div class="form-group">
							{{ form_errors(form.nom) }}
						</div>
						<div class="form-group">
							{{ form_widget(form.nom,{'attr': {'class': 'form-control', 'placeholder': 'Nom*'}}) }}
						</div>
						<div class="form-group">
							{{ form_errors(form.num_tel) }}
						</div>
						<div class="form-group">
							{{ form_widget(form.num_tel,{'attr': {'class': 'form-control', 'placeholder': 'Numéro de téléphone*','readonly': 'readonly'}}) }}
						</div>
						<div class="form-group">
							{{ form_errors(form.mail) }}
						</div>
						<div class="form-group">
							{{ form_widget(form.mail,{'attr': {'class': 'form-control', 'placeholder': 'Email*','readonly': 'readonly'}}) }}
						</div>
						<div class="form-group">
							{{ form_errors(form.mdp) }}
						</div>
						<div class="form-group">
							{{ form_widget(form.mdp,{'attr': {'class': 'form-control', 'placeholder': 'Ancien mot de passe*'}}) }}
						</div>
						<div class="form-group">
							{{ form_errors(form.newPassword) }}
						</div>
						<div class="form-group">
							{{ form_widget(form.newPassword,{'attr': {'class': 'form-control', 'placeholder': 'Nouveau mot de passe*'}}) }}
						</div>

						<div class="form-group text-center mt-3">
							<button type="submit" class="vs-btn w-100 style4">Enregistrer les modifications</button>
						</div>

						<div class="form-group text-center mt-3">
							<button type="button" id="cancelBtn" class="vs-btn w-100 style4">Annuler</button>
						</div>

						{{ form_end(form) }}

					{% endif %}
				</div>
			</div>
		</div>
	</div>
	<style>
		.profile-pic {
			width: 250px;
			height: 250px;
			object-fit: cover;
			border-radius: 50%;
			border: 6px solid #fff;
			box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
			transition: transform 0.3s ease;
		}

		.profile-pic:hover {
			transform: scale(1.05);
		}
		.hidden-file-input {
			display: none;
		}

		.form-group {
			color: #ff681a;

		}
	</style>
	<script>
		document.getElementById('user-photo').addEventListener('change', function (event) {
var previewContainer = document.querySelector('.custom-file-label');
if (event.target.files && event.target.files[0]) {
var imageUrl = URL.createObjectURL(event.target.files[0]);
previewContainer.innerHTML = '<img class="profile-pic" src="' + imageUrl + '" alt="Photo de profil">';
}
});

document.getElementById('cancelBtn').addEventListener('click', function (e) {
e.preventDefault();
Swal.fire({
title: 'Annulation',
text: 'Voulez-vous vraiment annuler vos modifications ?',
icon: 'warning',
showCancelButton: true,
confirmButtonColor: '#ff681a',
cancelButtonColor: ' #132a3e',
confirmButtonText: 'Oui, annuler',
cancelButtonText: 'Non, continuer'
}).then((result) => {
if (result.isConfirmed) {
window.history.back();
}
});
});
	</script>


{% endblock %}

{# Votre CSS et Javascript restent inchangés ci-dessous #}


{# Script pour mettre à jour la prévisualisation de l'image après sélection #}
